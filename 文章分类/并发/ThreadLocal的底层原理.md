# ThreadLocal的底层原理
- ThreadLocal是java中所提供的线程本地存储机制，可以利用该机制将数据缓存在某个线程内部，该线程可以在任意时刻、任意放啊中获得缓存的数据
- ThreadLocal底层是通过ThreadLocalMap来实现的，每个Thread对象中都有一个ThreadLocalMap，Map中的key为ThreadLocal对象，Map的value为需要缓存的值
- 如果在线程池中使用ThreadLcal会造成内存泄露，因为当ThreadLocal对象使用完成之后，应该把设置的key、value回收，也就是Entry对象进行回收，不会回收，而线程对象但线程池中的线程是通过强引用方式指向ThreadLocalMap，ThreadLocalMap也是通过强引用指向的Entry对象，所以导致线程和Entry对象无法回收，造成内存泄露，解决办法就是使用了Thread对象之后，手动调用Thread的remove方法，手动清除ThreadLocalMap中的Entry对象
- ThreadLocal经典的应用场景就是连接管理，每个线程都有自己的连接，这样就不需要在每个方法中传递一个Connection对象了